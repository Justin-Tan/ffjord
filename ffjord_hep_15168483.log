/data/cephfs/punim0011/jtan/github/ffjord/cnf_flow.py
Namespace(JFrobint=None, JdiagFrobint=None, JoffdiagFrobint=None, atol=1e-05, batch_norm=False, batch_size=1024, bn_lag=0, dataset='custom', dims='64-64-64', divergence_fn='brute_force', dl2int=None, early_stopping=16, evaluate=False, gpu=0, hdim_factor=10, l1int=None, l2int=None, layer_type='concatsquash', log_freq=10, lr=0.001, multigpu=False, n_epochs=32, nhidden=1, nonlinearity='tanh', num_blocks=1, rademacher=False, residual=False, resume=None, rtol=1e-05, save='experiments/cnf', solver='dopri5', spectral_norm=False, step_size=None, test_atol=None, test_batch_size=1024, test_rtol=None, test_solver=None, time_length=1.0, train_T=True, val_freq=256, viz_freq=100, weight_decay=1e-05)
Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
NumExpr defaulting to 8 threads.
chain.0.sqrt_end_time
chain.0.odefunc.odefunc._num_evals
chain.0.odefunc.odefunc.diffeq.layers.0._layer.weight
chain.0.odefunc.odefunc.diffeq.layers.0._layer.bias
chain.0.odefunc.odefunc.diffeq.layers.0._hyper_bias.weight
chain.0.odefunc.odefunc.diffeq.layers.0._hyper_gate.weight
chain.0.odefunc.odefunc.diffeq.layers.0._hyper_gate.bias
chain.0.odefunc.odefunc.diffeq.layers.1._layer.weight
chain.0.odefunc.odefunc.diffeq.layers.1._layer.bias
chain.0.odefunc.odefunc.diffeq.layers.1._hyper_bias.weight
chain.0.odefunc.odefunc.diffeq.layers.1._hyper_gate.weight
chain.0.odefunc.odefunc.diffeq.layers.1._hyper_gate.bias
chain.0.odefunc.odefunc.diffeq.layers.2._layer.weight
chain.0.odefunc.odefunc.diffeq.layers.2._layer.bias
chain.0.odefunc.odefunc.diffeq.layers.2._hyper_bias.weight
chain.0.odefunc.odefunc.diffeq.layers.2._hyper_gate.weight
chain.0.odefunc.odefunc.diffeq.layers.2._hyper_gate.bias
chain.0.odefunc.odefunc.diffeq.layers.3._layer.weight
chain.0.odefunc.odefunc.diffeq.layers.3._layer.bias
chain.0.odefunc.odefunc.diffeq.layers.3._hyper_bias.weight
chain.0.odefunc.odefunc.diffeq.layers.3._hyper_gate.weight
chain.0.odefunc.odefunc.diffeq.layers.3._hyper_gate.bias
SequentialFlow(
  (chain): ModuleList(
    (0): CNF(
      (odefunc): RegularizedODEfunc(
        (odefunc): ODEfunc(
          (diffeq): ODEnet(
            (layers): ModuleList(
              (0): ConcatSquashLinear(
                (_layer): Linear(in_features=36, out_features=256, bias=True)
                (_hyper_bias): Linear(in_features=1, out_features=256, bias=False)
                (_hyper_gate): Linear(in_features=1, out_features=256, bias=True)
              )
              (1): ConcatSquashLinear(
                (_layer): Linear(in_features=256, out_features=256, bias=True)
                (_hyper_bias): Linear(in_features=1, out_features=256, bias=False)
                (_hyper_gate): Linear(in_features=1, out_features=256, bias=True)
              )
              (2): ConcatSquashLinear(
                (_layer): Linear(in_features=256, out_features=256, bias=True)
                (_hyper_bias): Linear(in_features=1, out_features=256, bias=False)
                (_hyper_gate): Linear(in_features=1, out_features=256, bias=True)
              )
              (3): ConcatSquashLinear(
                (_layer): Linear(in_features=256, out_features=36, bias=True)
                (_hyper_bias): Linear(in_features=1, out_features=36, bias=False)
                (_hyper_gate): Linear(in_features=1, out_features=36, bias=True)
              )
            )
            (activation_fns): ModuleList(
              (0): Tanh()
              (1): Tanh()
              (2): Tanh()
            )
          )
        )
      )
    )
  )
)
Using 4 GPUs.
Number of trainable parameters: 152721
epoch:   0%|          | 0/32 [00:00<?, ?it/s]
Train:   0%|          | 0/3179 [00:00<?, ?it/s][A/data/cephfs/punim0011/jtan/github/ffjord/lib/layers/odefunc.py:288: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  t = torch.tensor(t).type_as(y)
Epoch 00 | Iter 0000 | Time 3.701(3.701) | Loss 37.248(37.248) | NFE Forward 20(20.0) | NFE Backward 21(21.0) | CNF Time 1.000(1.000)


val: 0it [00:00, ?it/s][A[A

val: 1it [00:00,  1.27it/s][A[A

val: 2it [00:01,  1.29it/s][A[A

val: 3it [00:02,  1.30it/s][A[A

val: 4it [00:03,  1.30it/s][A[A

val: 5it [00:03,  1.30it/s][A[A

val: 6it [00:04,  1.30it/s][A[A

val: 7it [00:05,  1.30it/s][A[A

val: 8it [00:06,  1.31it/s][A[A

val: 9it [00:06,  1.31it/s][A[A

val: 10it [00:07,  1.31it/s][A[A

[A[A[VAL] Epoch 00 | Val Loss 36.849 | NFE 20 | NoImproveEpochs 01/16

Train:   0%|          | 1/3179 [00:11<9:59:13, 11.31s/it][A
Train:   0%|          | 2/3179 [00:13<5:57:45,  6.76s/it][A
Train:   0%|          | 3/3179 [00:15<4:37:37,  5.24s/it][A
Train:   0%|          | 4/3179 [00:17<3:57:12,  4.48s/it][A
Train:   0%|          | 5/3179 [00:20<3:37:28,  4.11s/it][A
Train:   0%|          | 6/3179 [00:23<3:24:36,  3.87s/it][A
Train:   0%|          | 7/3179 [00:25<3:15:26,  3.70s/it][A
Train:   0%|          | 8/3179 [00:28<3:08:15,  3.56s/it][A
Train:   0%|          | 9/3179 [00:31<3:02:39,  3.46s/it][A
Train:   0%|          | 10/3179 [00:33<2:58:14,  3.37s/it][AEpoch 00 | Iter 0010 | Time 2.630(3.518) | Loss 35.556(36.819) | NFE Forward 20(20.0) | NFE Backward 27(22.5) | CNF Time 1.000(1.000)

Train:   0%|          | 11/3179 [00:36<2:54:36,  3.31s/it][A
Train:   0%|          | 12/3179 [00:39<2:51:34,  3.25s/it][A
Train:   0%|          | 13/3179 [00:41<2:48:58,  3.20s/it][A
Train:   0%|          | 14/3179 [00:44<2:46:42,  3.16s/it][A
Train:   0%|          | 15/3179 [00:46<2:44:45,  3.12s/it][A
Train:   1%|          | 16/3179 [00:49<2:43:06,  3.09s/it][A
Train:   1%|          | 17/3179 [00:52<2:42:14,  3.08s/it][A
Train:   1%|          | 18/3179 [00:55<2:41:33,  3.07s/it][A
Train:   1%|          | 19/3179 [00:58<2:40:57,  3.06s/it][A
Train:   1%|          | 20/3179 [01:00<2:40:19,  3.05s/it][AEpoch 00 | Iter 0020 | Time 2.862(3.260) | Loss 34.724(36.233) | NFE Forward 26(21.1) | NFE Backward 27(24.0) | CNF Time 1.000(1.000)

Train:   1%|          | 21/3179 [01:03<2:39:48,  3.04s/it][A
Train:   1%|          | 22/3179 [01:06<2:39:19,  3.03s/it][A
Train:   1%|          | 23/3179 [01:09<2:38:56,  3.02s/it][A
Train:   1%|          | 24/3179 [01:12<2:38:32,  3.02s/it][A
Train:   1%|          | 25/3179 [01:15<2:38:09,  3.01s/it][A
Train:   1%|          | 26/3179 [01:18<2:38:36,  3.02s/it][A
Train:   1%|          | 27/3179 [01:21<2:38:16,  3.01s/it][A
Train:   1%|          | 28/3179 [01:24<2:37:57,  3.01s/it][A
Train:   1%|          | 29/3179 [01:27<2:37:36,  3.00s/it][A
Train:   1%|          | 30/3179 [01:29<2:37:16,  3.00s/it][AEpoch 00 | Iter 0030 | Time 2.850(3.138) | Loss 32.284(35.300) | NFE Forward 26(22.7) | NFE Backward 27(25.2) | CNF Time 1.000(1.000)

Train:   1%|          | 31/3179 [01:32<2:36:58,  2.99s/it][A
Train:   1%|          | 32/3179 [01:35<2:36:39,  2.99s/it][A
Train:   1%|          | 33/3179 [01:38<2:36:24,  2.98s/it][A
Train:   1%|          | 34/3179 [01:41<2:36:10,  2.98s/it][A